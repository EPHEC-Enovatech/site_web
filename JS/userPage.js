function calculateSizeMain(){let tailleHeader=parseFloat((($('#document_Header').css('height')).split("px"))[0]);$('#document_Main').css('height',"calc(100vh - "+tailleHeader+"px)");$('#menuUser').css('max-height',"calc(100vh - "+tailleHeader+"px)");$('#contentZone').css('max-height',"calc(100vh - "+tailleHeader+"px)");$('#sideNav').css('max-height',"calc(100vh - "+tailleHeader+"px)")}
function loadHTML(page){const load='<div id="loadingDiv" class="lds-ripple"><div></div><div></div></div>';const contentZone=$('#content');if(page===undefined){contentZone.html("<p>Vous allez être redirigé sur notre site</p>")}else{setLoading(1);contentZone.load("userHTML/"+page+".html",function(response,status,xhr){setLoading();if(status==="error"){contentZone.html("<p>Impossible de charger le contenu, vérifier votre connexion internet</p>")}})}}
function toggleHoverMenu(li){$('.sousMenu').removeClass('currentUserMenu');$('.'+li.classList[1]).addClass('currentUserMenu')}
function toggleSlideMenu(){if(window.innerWidth<=600){$('#menuUser').show().css("max-height","100vh").css("height","100vh");$('#sideNav').css("height",window.innerHeight).css("max-height",window.innerHeight);$('.menu-link').show().bigSlide({menu:'#menuUser',easyClose:!0,})}else{$('#sideNav').css("height","auto");$('#menuUser').css("position","initial").css("left",0).css("width","auto").css("height","auto");$('.menu-link').hide();calculateSizeMain()}}
function centerLoading(){let contentZone=$('#contentZone');let largeur=(contentZone.width()/2)-64/4;let hauteur=contentZone.height()/2;$('#loadingDiv').css("top",hauteur+"px").css("left",largeur+"px")}
let dataChange={"idBox":"","value":"","oldValue":"","action":""};let countCall=0;function setLoading(nombre=0){let loading=$('#loadingDiv');let connection=navigator.connection||navigator.mozConnection||navigator.webkitConnection;if(connection=connection!==undefined?connection.rtt>60:!0){if(nombre>0){loading.show();centerLoading();countCall+=nombre}else{if(countCall>0){countCall-=1}}}
    if(countCall===0)loading.hide()}
$(function(){moment.locale("fr");$('.sousMenu').on("click",function(e){if(e.target.hasAttribute("href")){loadHTML(e.target.parentNode.id);toggleHoverMenu(e.target.parentElement)}else{loadHTML($(this).attr('id'));toggleHoverMenu(e.target)}});centerLoading();$(window).on("resize",function(){toggleSlideMenu();centerLoading()});$(".logout").click((e)=>{e.preventDefault();deleteCookie('token');deleteCookie('user-id');if(e.target.href!==undefined){window.location=e.target.href}else{window.location="index.html"}});if((parseJWT(getCookie("token"))).admin){$('#adminPage').show()}
    calculateSizeMain();toggleSlideMenu();if(getUrlParameter("box")===undefined&&getUrlParameter("check")===undefined){loadHTML("userInfo")}else{loadHTML("addBox")}
    $('#laterCache').on("click",function(){$('#dialWebApp').hide()})});function showUserInfo(response,textStatus){if(response.status===401){cookiesExpireTime()}
    setLoading();let nomUser=response.responseJSON.data.prenom+" "+response.responseJSON.data.nom;$('title').html("Profil "+nomUser);$('#userWelcome').html(nomUser);$('#userName').val(response.responseJSON.data.nom);$('#userSurname').val(response.responseJSON.data.prenom);$('#userMail').val(response.responseJSON.data.email)}
function getCookie(cname){var name=cname+"=";var decodedCookie=decodeURIComponent(document.cookie);var ca=decodedCookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' '){c=c.substring(1)}
    if(c.indexOf(name)==0){return c.substring(name.length,c.length)}}
    return""}
function cookiesExpireTime(){$("#disconnectDiv").load("lostConnection.html")}
function trapFocus(element,namespace){var focusableEls=element.querySelectorAll('a[href], button, textarea, input[type="text"], input[type="email"], input[type="submit"], input[type="reset"]'),firstFocusableEl=focusableEls[0];lastFocusableEl=focusableEls[focusableEls.length-1];KEYCODE_TAB=9;firstFocusableEl.focus();element.addEventListener('keydown',function(e){var isTabPressed=(e.key==='Tab'||e.keyCode===KEYCODE_TAB);if(!isTabPressed){return}
    if(e.shiftKey){if(document.activeElement===firstFocusableEl){lastFocusableEl.focus();e.preventDefault()}}else{if(document.activeElement===lastFocusableEl){firstFocusableEl.focus();e.preventDefault()}}})}